<html>
  <style>
    #wordRacerBoard {
      width: 150px;
      height: 150px;
    }
    #answers {
      border-top: 1px solid black;
      padding-top: 10px;
    }
  </style>
  <head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  </head>
  <div>Let's solve some word racer problems!</div>
  <div>Create your puzzle below.</div>
  <textarea id="wordRacerBoard">
abcdXXe&#13;
efghXXf&#13;
ijelXgh&#13;
mnozema&#13;
</textarea>
  <div>
  <input type="Submit" onclick="ctrl.submitBoard();" value="Submit"></input>
  </div>
  <div>Answers below :)</div>
  <div id="answers">
  </div>
  <script>
    Board = function(text) {
      this.text = text;
    };

    Board.prototype.printSolution = function(linesAsText) {
      var words = linesAsText.split(',');
      var html = '';
      for (var i = words.length -1; i >= 0; i--) {
        var word = words[i];
        html += '<div>' + word + '</div>';
      }
      $('#answers').html(html);
    };

    Board.prototype.solve = function() {
      var text = this.text;
      var lines = text.split('\n');
      // Validate the board works.
      var length = lines[0].length;
      window.console.log(this.text);
      var that = this;
      $.ajax('/wordracer_json?board=' + text + '&length=' + length)
        .done(function(data) {
          that.printSolution(data);
          window.console.log('success');
          window.console.log(data);
        });    
    };

    var ctrl = {};

    ctrl.getBoardText = function() {
      return $('#wordRacerBoard').val();
    };

    ctrl.submitBoard = function() {
      var text = ctrl.getBoardText();
      var b = new Board(text);
      b.solve();
    };

    ctrl.init_ = function() {
      window.console.log("ready for damage");
    };
    $(document).ready(ctrl.init_);
  </script>
</html>
